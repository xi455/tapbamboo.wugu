<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="main.css">
    <title>Document</title>
</head>

<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="./">
        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bar-chart-fill" fill="currentColor"
             xmlns="http://www.w3.org/2000/svg">
            <rect width="4" height="5" x="1" y="10" rx="1"/>
            <rect width="4" height="9" x="6" y="6" rx="1"/>
            <rect width="4" height="14" x="11" y="1" rx="1"/>
        </svg>
        紫雲農場 - 觀音山有機綠竹筍專作
    </a>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <!--            <ul class="navbar-nav mr-auto">-->
        <!--                <li class="nav-item active">-->
        <!--                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>-->
        <!--                </li>-->
        <!--                <li class="nav-item">-->
        <!--                    <a class="nav-link" href="#">Link</a>-->
        <!--                </li>-->
        <!--                <li class="nav-item dropdown">-->
        <!--                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
        <!--                        Dropdown-->
        <!--                    </a>-->
        <!--                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">-->
        <!--                        <a class="dropdown-item" href="#">Action</a>-->
        <!--                        <a class="dropdown-item" href="#">Another action</a>-->
        <!--                        <div class="dropdown-divider"></div>-->
        <!--                        <a class="dropdown-item" href="#">Something else here</a>-->
        <!--                    </div>-->
        <!--                </li>-->
        <!--            </ul>-->
    </div>
</nav>

<div class="container">
    <div class="row">
        <div class="col-3">
            <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                <a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-origin" role="tab"
                   aria-controls="v-pills-home" aria-selected="true">緣起</a>
                <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-introduction" role="tab"
                   aria-controls="v-pills-profile" aria-selected="false">介紹</a>
                <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-product" role="tab"
                   aria-controls="v-pills-messages" aria-selected="false">產品</a>
                <a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-shops" role="tab"
                   aria-controls="v-pills-settings" aria-selected="false">購物車 <span id="ShopCount"
                                                                                    class="badge badge-light">0</span></a>
                <a class="nav-link" id="v-pills-shops-tab" data-toggle="pill" href="#v-pills-messageBoard" role="tab"
                   aria-controls="v-pills-settings" aria-selected="false">留言板</a>
                <a class="nav-link" id="v-pills-deeds-tab" data-toggle="pill" href="#v-pills-deeds" role="tab"
                   aria-controls="v-pills-settings" aria-selected="false">榮耀事蹟</a>
                <a class="nav-link" id="v-pills-delicacy-tab" data-toggle="pill" href="#v-pills-delicacy" role="tab"
                   aria-controls="v-pills-settings" aria-selected="false">竹筍佳餚</a>
            </div>
        </div>

        <div class="col-9">
            <div class="tab-content" id="v-pills-tabContent">
                <div class="tab-pane fade show active" id="v-pills-origin" role="tabpanel"
                     aria-labelledby="v-pills-home-tab">緣起<br>
                     <table border="1" width="500" height="400">
                         <tr>
                             <td>
                                 <img src="竹筍熊.jpg" alt="">
                             </td>
                         </tr>
                        </table>
                </div>
                <div class="tab-pane fade" id="v-pills-introduction" role="tabpanel" aria-labelledby="v-pills-profile-tab">
                    <div>1953年，我的爸爸吳國池出生在旗竿湖─一個盡是綠竹林的地方，我的媽媽楊春則出生在處處可見孟宗竹林的南投，43年前他們倆相遇時，爸爸已完成了醫學院的學業，順利進入三軍總醫院擔任檢驗師。後來同一時期，家族的考驗無聲的來到，做牙醫的大伯決定開業，叔叔們一個當兵、一個就學。爸爸面對家業無人傳承的境況，做出了人生最重大的決定─棄醫從農。</div>
                </div>
                <div class="tab-pane fade" id="v-pills-product" role="tabpanel" aria-labelledby="v-pills-messages-tab">
                    產品
                </div>
                <div class="tab-pane fade" id="v-pills-shops" role="tabpanel" aria-labelledby="v-pills-settings-tab">
                    <div class="container">
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="card" style="width: 18rem;">
                                    <img src="https://i.imgur.com/Oi8nfUk_d.webp?maxwidth=760&fidelity=grand"
                                         class="card-img-top" alt="...">
                                    <div class="card-body text-center">
                                        <h5 class="card-title">標題</h5>
                                        <p class="card-text">內容</p>
                                        <p class="card-text">價錢:$20</p>
                                        <a href="#" class="btn btn-primary addInShops" i-name="a" i-value="20">加入購物車</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="card" style="width: 18rem;">
                                    <img src="https://i.imgur.com/Oi8nfUk_d.webp?maxwidth=760&fidelity=grand"
                                         class="card-img-top" alt="...">
                                    <div class="card-body text-center">
                                        <h5 class="card-title">標題</h5>
                                        <p class="card-text">內容</p>
                                        <p class="card-text">價錢:$20</p>
                                        <a href="#" class="btn btn-primary addInShops" i-name="b" i-value="20">加入購物車</a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row shopsBoard mt-2">

                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="v-pills-messageBoard" role="tabpanel"
                     aria-labelledby="v-pills-settings-tab">
                    <div class="row mt-1 input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">標題</span>
                        </div>
                        <input type="text" class="form-control rounded-right" id="messageTitle" placeholder="請輸入標題"
                               required>
                    </div>

                    <div class="row mt-1 input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">內容</span>
                        </div>
                        <input type="text" class="form-control rounded-right" id="messageContent" placeholder="請輸入內容"
                               required>
                    </div>

                    <div class="text-center mt-2">
                        <button class="btn btn-primary w-25" id="sendMessageBoardBtn">送出</button>
                        <button class="btn btn-primary w-25" id="resetMessageBoardBtn">重設</button>
                    </div>

                    <div class="mt-5 messageBoard">

                    </div>
                </div>
                <div class="tab-pane fade" id="v-pills-deeds" role="tabpanel" aria-labelledby="v-pills-settings-tab">
                    榮耀事蹟
                </div>
                <div class="tab-pane fade" id="v-pills-delicacy" role="tabpanel" aria-labelledby="v-pills-settings-tab">
                    竹筍佳餚
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('#sendMessageBoardBtn').click(function () {
            let message = JSON.parse(localStorage.message);
            let title = $('#messageTitle').val();
            let content = $('#messageContent').val();

            if (title.length === 0 || content.length === 0) {
                alert('標題或內容不能為空');
            } else {
                message.push({
                    'title': $('#messageTitle').val(),
                    'content': $('#messageContent').val()
                })

                localStorage.message = JSON.stringify(message)

                loadMessages();
            }
        });

        $('#resetMessageBoardBtn').click(function () {
            $('#messageTitle').val('');
            $('#messageContent').val('');
        });

        $('.addInShops').click(function () {
            let shops = JSON.parse(localStorage.shops);
            let name = $(this).attr('i-name');
            let cost = $(this).attr('i-value');

            shops.push({
                'name': name,
                'cost': cost
            });

            localStorage.shops = JSON.stringify(shops);
            loadShops();
        });

        function initialize() {
            if (localStorage.getItem('message') === null) {
                localStorage.message = JSON.stringify([]);
            }

            if (localStorage.getItem('shops') === null) {
                localStorage.shops = JSON.stringify([]);
            }

            loadMessages();
            loadShops();
        }

        function loadShops() {
            $('.shopsBoard *').remove();
            $('.shopsBoard').append(createTable('shops', ['名稱', '價錢', '刪除']));
            $('#ShopCount').text(JSON.parse(localStorage.shops).length);
        }

        function loadMessages() {
            $('.messageBoard *').remove();
            $('.messageBoard').append(createTable('message', ['標題', '內容', '刪除']));
        }

        function createTable(storageKey, theadData, deleteButton = true) {
            let table = $('<table></table>');
            let thead = $('<thead></thead>');
            let tbody = $('<tbody></tbody>');
            let storageData = JSON.parse(localStorage.getItem(storageKey));

            theadData.forEach(item => {
                $(thead).append(`<th>${item}</th>`);
            });

            storageData.forEach((item, index) => {
                let tr = $('<tr></tr>');

                for (let key in item) {
                    $(tr).append(`<td>${item[key]}</td>`);

                }

                if (deleteButton) {
                    let button = $('<button class="btn btn-danger">刪除</button>');
                    let td = $('<td></td>');

                    $(button).click(() => {
                        storageData.splice(index, 1);
                        localStorage[storageKey] = JSON.stringify(storageData);
                        loadMessages();
                        loadShops();
                    });

                    $(td).append(button);
                    $(tr).append(td);
                }


                $(tbody).append(tr);
            });

            $(table).append(thead, tbody);

            return $(table);
        }

        initialize();
    });
</script>
</body>

</html>
